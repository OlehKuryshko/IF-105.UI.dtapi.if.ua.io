<ng-template #loadingBlock>
    <mat-progress-bar mode="indeterminate"></mat-progress-bar>
</ng-template>
<div class="container">
    <div class="title-box">
        <h3>Відповіді до тесту {{testName}}</h3>
        <a mat-raised-button class="add-link" color="prime" routerLink="new">
            <mat-icon aria-hidden="false" aria-label="add">add</mat-icon>
            Додати питання
        </a>
      </div>
    
    
      
      <table mat-table #table
           [dataSource]="questions" multiTemplateDataRows
           class="mat-elevation-z8"
           *ngIf="!loadingQuestions; else loadingBlock">
    
        <ng-container matColumnDef='No'>
            <th mat-header-cell *matHeaderCellDef> № </th>
            <td mat-cell *matCellDef="let question; let i = dataIndex;"> 
                {{ i+1 }}
            </td>
        </ng-container>
    
        <ng-container matColumnDef="question_text">
            <th mat-header-cell *matHeaderCellDef> Текст </th>
            <td mat-cell *matCellDef="let question"> {{ question.question_text }} </td>
        </ng-container>
    
        <ng-container matColumnDef="type">
            <th mat-header-cell *matHeaderCellDef> Тип </th>
            <td mat-cell *matCellDef="let question"> {{ question.type | questionType }} </td>
        </ng-container>
    
        <ng-container matColumnDef="level">
            <th mat-header-cell *matHeaderCellDef> Рівень </th>
            <td mat-cell *matCellDef="let question"> {{ question.level }} </td>
        </ng-container>
    
        <ng-container matColumnDef="attachment">
            <th mat-header-cell *matHeaderCellDef> Зображення </th>
            <td mat-cell *matCellDef="let question"> 
                <img 
                    [src]="question.attachment"
                    class="attachmet-preview-image margin-y"
                    *ngIf="question.attachment"
                    alt="Зображення">
            </td>
        </ng-container>
    
        <ng-container matColumnDef='delete'>
            <th mat-header-cell *matHeaderCellDef></th>
            <td mat-cell *matCellDef="let question" class="actions"> 
                <!-- <mat-icon aria-hidden="false" aria-label="edit" (click)="editGroupDialog(group)">edit</mat-icon> -->
                <mat-icon aria-hidden="false" aria-label="delete" (click)="deleteQuestion(question.question_id)">delete</mat-icon>
                <a [routerLink]="[question.question_id, 'edit']">
                    <mat-icon aria-hidden="false" aria-label="edit">settings_applications</mat-icon>
                </a>
            </td>
        </ng-container>
    
        <tr mat-header-row *matHeaderRowDef="['No', 'question_text', 'type', 'level',  'attachment', 'delete']"></tr>
        <tr mat-row *matRowDef="let question; columns: ['No', 'question_text', 'type', 'level',  'attachment', 'delete'];"
            class="question-row">
        </tr>
    </table>
    <mat-paginator
        [pageSizeOptions]="[5, 10, 20]"
        [pageSize]="pageSize"
        showFirstLastButtons
        [length]="questionsCount"
        (page)="pageEvent = pageChangeHandler($event)">
    </mat-paginator>
</div>
